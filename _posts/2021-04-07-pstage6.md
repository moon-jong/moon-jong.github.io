---
title: Pstage6 고생끝에 복이 오니
---

# 그토록 바랐던 성능향상
아기다리 고기다리던 순간이었다.
처음 순수 backbone model에서 아무것도 하지않고 그냥 제출했을 때 72 acc과 0.62 f1 score를 기록하였다.
하지만 이후 무슨짓을 하더라도 모델 성능이 향상되지않아 갑갑한 마음이었다.

문제는 data augmentation과  test시 normalization의 부재였다.
## 문제
1. data augmentation

정말 augmentation이 문제일줄은 상상도 못했다.
실제로 augmentation이 성능 향상에 도움을 주었다는 분들도 계셨기에 내가 만든 모델에서 성능 하락의 원인이 되리라고는 상상도 못했다.
하지만 모든 augmentation을 없애보니 77 acc 0.7274 f1 score가 나왔다.

문제는 Centercrop으로 보인다.
모든 데이터가 배경과 얼굴이 잘 보이는 정말로 잘 정제된 데이터들이지만 가끔가다 과도하게 얼굴이 꽉차있는 사진들도 있었다.

이런 사진들에 Centorcrop을 적용하면 눈, 코 등이 사라지고 마스크만 나오는 사진이 출력되기도 한다.

2. normalization

왜 그랬는지 모르겠지만 inference시 transform은 normalization이 빠져있었다.
학습때 모델이 보았던 값과는 확연히 다른 값들을 예측시 보게되어 완전히 다른 값을 도출하는 현상이 일어난것같다.


# 현재 시도하고 있는것

오늘 진행한 피어세션에서 18개 클래스를 한번에 예측하는것이 아닌 8개의 vector로 3-hot encoding으로 학습하여 성능을 높였다는 이야기를 듣고 시도해보는 중이다.

18개 클래스를 한번에 예측하는 것이 아닌 길이 8의 벡터를 만들고 3hot encoding을 진행하여 모델을 학습시키고 있다.

[0, 0, 0, 0, 0, 0, 0, 0]의 첫번째 두개 원소는 성별 그 다음 세개는 나이 그 다음 세개는 마스크 착용 여부를 나타내는 원소들이다.

Loss또한 슬라이싱을 이용하여 세개의 Loss를 더하고 학습을 진행중이다.
