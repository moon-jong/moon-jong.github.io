---
title: Pstage day1 이미지 분류모델 생성
tags:
- ComputerVision
---

# 베이스라인 작성을 해보자!
연령, 성별 마스크 착용 여부를 18가지 클래스로 분류하는 경진대회가 첫번째 관문이다.
AIstages에서 제공하는 GPU를 마음놓고 사용할 수 있다는게 정말 큰 장점이다. ~~코랩처럼 끊기지가 않아서 정말좋다. 모델 돌려놓고 학습정리하기도 편하다~~

베이스라인으로 주어진 코드는 굉장히 단순한 모델에 test_set을 이용하여 학습되지 않은 모델을 통하여 inference를 하고 submission까지 완료하는 코드였다.

때문에 데이터가 어떤식으로 주어졌는지 알아보고 inference할 수 있도록 데이터셋을 재구축하였다.

## 데이터 구조
데이터는 input/train/images/성별,나이,인종/mask1.jpg ---- normal 로 폴더 안의 폴더구조로 되어있었다.
dataset.ImageFolder를 사용하기 위해서 각 라벨별로 디렉토리를 다시 만들었고 그 안에 라벨에 맞는 이미지들을 집어넣었다.

이 과정에서 몇가지 변수가 발생하였다.

1. 성별, 나이, 인종 폴더 내부에 사진들의 이름이 전부 같았기 때문에 각 라벨 디렉토리에 사진이 겹쳐져 1장에서 5장정도로 생성되어 이미지 이름을 '성별, 나이, 인종_사진이름'으로 바꾸어준 뒤 각 라벨 디렉토리에 할당하 였다.

2. os.listdir()로 디렉토리 내부의 파일들을 불러오면 '.'으로 시작하는 숨김파일들도 같이 불러와져 glob을 사용하였다.

## 라벨별로 사진을 분류하였는데 성능은...
라벨별로 디렉토리를 생성한 후 torchvision의 datasets.ImageFolder를 이용하여 dataset을 만들고 로드하였지만 최종 제출시 클래스가 3, 4, 11, 12밖에 출력되지 않았다.
데이터셋을 로딩할 때 문제가 있어보이지만 아직 뚜렷한 원인을 발견하지는 못했고 dataset의 class_to_idx를 1:1로 맞춰준 뒤 다시 모델을 학습시키고있다.

## 베이스라인 짜는것도 쉬운일은 아니네...
단지 라벨별로 분류를 하고 학습을 통하여 inference를 하는 코드를 구현하는것만 해도 쉬운일이 아닌것같다.
하지만 라벨 디렉토리별로 사진을 옮겨놓았고 이제 여러가지 backbone모델을 사용하여 시도해볼 일만 남았다.
